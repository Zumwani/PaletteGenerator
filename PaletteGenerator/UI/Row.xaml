<ResourceDictionary x:Class="PaletteGenerator.UI.RowTemplate"
                    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:ui="clr-namespace:PaletteGenerator.UI"
                    xmlns:local="clr-namespace:PaletteGenerator"
                    xmlns:converters="clr-namespace:PaletteGenerator.Converters">
    
    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="Button.xaml"/>
    </ResourceDictionary.MergedDictionaries>
    
    <DataTemplate DataType="{x:Type local:Row}">

        <DataTemplate.Resources>

            <Style TargetType="{x:Type ItemsControl}">

                <Setter Property="VirtualizingPanel.IsVirtualizing"     Value="True"/>
                <Setter Property="VirtualizingPanel.VirtualizationMode" Value="Recycling"/>

                <Setter Property="ItemTemplate">
                    <Setter.Value>
                        <DataTemplate DataType="{x:Type Color}">
                            <Rectangle Width="64" Height="64" Fill="{Binding Converter={converters:ToBrush}}"/>
                        </DataTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="ItemsPanel">
                    <Setter.Value>
                        <ItemsPanelTemplate>
                            <VirtualizingStackPanel Orientation="Horizontal"/>
                        </ItemsPanelTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

        </DataTemplate.Resources>
        
        <StackPanel Orientation="Horizontal" Margin="0,6">

            <ui:ColorEditor Color="{Binding Source={x:Static local:App.Window}, Path=LeftColor, Mode=TwoWay}" BorderThickness="1,1,0,1"/>
            <ItemsControl ItemsSource="{Binding Left}"/>
            <ui:ColorEditor Color="{Binding Center, Mode=TwoWay}" ColorChanged="CenterColorChanged" BorderThickness="0,1"/>
            <ItemsControl ItemsSource="{Binding Right}"/>
            <ui:ColorEditor Color="{Binding Source={x:Static local:App.Window}, Path=RightColor, Mode=TwoWay}" BorderThickness="0,1,1,1"/>

            <Canvas>
                <Button VerticalAlignment="Center" FontSize="12" Margin="4,0" Click="Remove" Foreground="DimGray" Content="✖"/>
            </Canvas>

        </StackPanel>

    </DataTemplate>

</ResourceDictionary>